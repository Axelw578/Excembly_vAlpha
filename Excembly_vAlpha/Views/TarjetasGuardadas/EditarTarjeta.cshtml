@model Excembly_vAlpha.ViewModels.EditarTarjetaViewModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml"; // Ajusta el layout según tu proyecto
}

<h2 class="text-center mt-4">Editar Tarjeta</h2>

<div class="container mt-5">
    <form asp-action="EditarTarjeta" method="post" id="editarTarjetaForm" class="needs-validation" novalidate>
        <input type="hidden" asp-for="TarjetaId" />

        <!-- Nombre del Titular -->
        <div class="row mb-3">
            <label asp-for="NombreTitular" class="form-label col-md-4 col-form-label text-md-end">Nombre del Titular:</label>
            <div class="col-md-6">
                <input asp-for="NombreTitular" class="form-control" required />
                <div class="invalid-feedback">
                    Por favor, ingresa el nombre del titular.
                </div>
            </div>
        </div>

        <!-- Mes de Expiración -->
        <div class="row mb-3">
            <label asp-for="MesExpiracion" class="form-label col-md-4 col-form-label text-md-end">Mes de Expiración:</label>
            <div class="col-md-3">
                <input asp-for="MesExpiracion" class="form-control" type="number" min="1" max="12" required />
                <div class="invalid-feedback">
                    Por favor, ingresa un mes válido (1-12).
                </div>
            </div>
        </div>

        <!-- Año de Expiración -->
        <div class="row mb-3">
            <label asp-for="AñoExpiracion" class="form-label col-md-4 col-form-label text-md-end">Año de Expiración:</label>
            <div class="col-md-3">
                <input asp-for="AñoExpiracion" class="form-control" type="number" min="@DateTime.Now.Year" required />
                <div class="invalid-feedback">
                    Por favor, ingresa un año válido mayor o igual a @DateTime.Now.Year.
                </div>
            </div>
        </div>

        <!-- CVV -->
        <div class="row mb-3">
            <label asp-for="CVV" class="form-label col-md-4 col-form-label text-md-end">CVV:</label>
            <div class="col-md-3">
                <input asp-for="CVV" class="form-control" type="password" maxlength="3" pattern="\d{3}" required />
                <div class="invalid-feedback">
                    El CVV debe ser un número de 3 dígitos.
                </div>
            </div>
        </div>

        <!-- Botones -->
        <div class="row">
            <div class="col-md-8 offset-md-4">
                <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                <a asp-action="Index" class="btn btn-secondary ms-2">Cancelar</a>
            </div>
        </div>
    </form>

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger mt-4">@TempData["Error"]</div>
    }
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        // Bootstrap validation
        (function () {
            'use strict';
            const forms = document.querySelectorAll('.needs-validation');
            Array.from(forms).forEach(form => {
                form.addEventListener('submit', event => {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        })();
    </script>
}
